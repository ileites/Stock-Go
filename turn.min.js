/*! turn.js 4.1.0 | Copyright (c) 2012 Emmanuel Garcia | turnjs.com | turnjs.com/license.txt */
!function(a){"use strict";function b(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function c(c,d){d=d||{};var e={},f=a.extend({width:null,height:null,display:"single",acceleration:!0,elevation:50,gradient:!0,autoCenter:!0,turnCorners:"bl,br",when:{}},d);if(f.display!="single"&&f.display!="double")throw new Error('Display "'+f.display+'" is not valid.');c.data({options:f,pageObjs:{},pages:{},pageWrap:{},pagePlace:e,pageMv:[],zoom:1,totalPages:f.pages||0,eventHandlers:{turning:a.Event("turning"),turned:a.Event("turned"),zooming:a.Event("zooming"),missing:a.Event("missing"),start:a.Event("start"),end:a.Event("end"),first:a.Event("first"),last:a.Event("last")}});var g=c.data();return"function"==typeof f.when.starting&&c.bind("starting",f.when.starting),c.bind("turned",function(b,c,d){var e=a(this).data("pagePlace");if(e[c]){var f=a(this).data("pageWrap");e[c].parent().hasClass("hard")||f[c].show()}for(var g=0;g<d.length;g++)e[d[g]]&&e[d[g]].parent().hasClass("hard")||f[d[g]].show()}).bind("start",function(b,c){var d=a(this),e=d.data("pagePlace");c.page=c.page||1,c.next=c.next||c.page+1,d.data("pageMv",[{page:c.page,next:c.next,corner:c.corner}]),e[c.page]&&e[c.page].parent().hide(),e[c.next]&&e[c.next].parent().hide()}).bind("end",function(b,c){a(this).data("pageMv",[])}).bind("missing",function(a,b){for(var c=0;c<b.length;c++)l.addPage.call(this,b[c])}),l.addInsideBook.call(c),l.showing.call(c),l.autobind.call(c),c.turn("page",f.page),f.autoCenter&&c.turn("center"),c}var d={init:function(b){return this.turn.apply(this,arguments).data("turn")},is:function(){return"object"==typeof this.data("turn")},version:function(){return"4.1.0"},data:function(){return this.data()},options:function(c){if(void 0===c)return this.data("options");l.options.call(this,c);var d=this.data(),e=d.pagePlace,f=d.pageWrap;return d.totalPages&&l.pageNumbers.call(this,d.page,d.totalPages),d.options.autoCenter&&this.turn("center"),l.updateShadow.call(this),this.turn("update")},destroy:function(){var b=this,c=this.data(),d=a.extend({},c.eventHandlers);return this.unbind("end").unbind("first").unbind("last").unbind("missing").unbind("start").unbind("turning").unbind("turned").unbind("zooming"),c=null,this.data("turn",null),this.removeData(),this.empty(),this.bind("end",d.end).bind("first",d.first).bind("last",d.last).bind("missing",d.missing).bind("start",d.start).bind("turning",d.turning).bind("turned",d.turned).bind("zooming",d.zooming),b},size:function(a,b){return void 0===a||void 0===b?{width:this.width(),height:this.height()}:(l.resize.call(this,a,b),this)},page:function(a){if(void 0===a)return this.data("page");var b=this.data();return b.page!=a&&(b.options.display=="double"&&a%2||a<=0||a>b.totalPages||a in b.pageMv.map(function(a){return a.page})||(b.page=a,l.moveTo.call(this,a))),this},pages:function(a){var b=this.data();return a?(a!=b.totalPages&&(b.options.pages=a,b.totalPages=a,l.createBook.call(this)),this):b.totalPages},next:function(){return this.turn("page",l.nextPage.call(this))},previous:function(){return this.turn("page",l.previousPage.call(this))},addPage:function(a,b){var c=this.data();if(b<1||b>c.totalPages+1)throw new Error("Page "+b+" cannot be inserted");var d=!1;return b<=c.totalPages&&(c.totalPages++,d=!0,l.pageNumbers.call(this,b,c.totalPages)),l.addPage.call(this,b,a)&&(d&&this.turn("page",b),this.turn("update",!0)),this},removePage:function(b){var c=this.data();if(b<1||b>c.totalPages)throw new Error("Page "+b+" doesn't exist");var d=c.pagePlace;return d[b]&&d[b].remove(),delete d[b],c.totalPages--,c.page>c.totalPages?this.turn("page",c.totalPages):l.pageNumbers.call(this,b,c.totalPages),this},hasPage:function(a){return b(this.data().pagePlace,a)},center:function(b){var c=this.data(),d=a(this).turn("size"),e=0;return c.options.autoCenter&&(c.options.display=="double"&&(e=this.turn("view",c.page).join("").length?d.width/2-d.height:d.width/4-d.height),this.css({marginLeft:e})),this},display:function(a){var b=this.data(),c=b.options.display;if(void 0===a)return c;if(a!=c){var d=this.turn("page");l.display.call(this,a),"double"==a?this.turn("center"):this.css({marginLeft:0});var e=this.turn("page");d!=e&&this.turn("page",e)}return this},corner:function(){},disable:function(a){this.data().disabled=a===!0;var b=this.data("pageMv");for(var c=0;c<b.length;c++)b[c].ignore=!0},disabled:function(a){return void 0===a?this.data().disabled===!0:this.turn("disable",a)},view:function(a){var b=this.data();if(a=a||b.page,"double"==b.options.display){var c=a-1;return c>0&&a%2==0?l.view.call(this,c):l.view.call(this,a)}return l.view.call(this,0)},stop:function(){if(!this.data("disabled")){var a=this.data(),b=a.pageMv;a.pageMv=[];for(var c=0;c<b.length;c++){var d=b[c];d.solve&&d.solve.call(d.context,d.corner,d.x,d.percent)}this.turn("update")}return this},calculateZ:function(a){return l.calculateZ.call(this,a)},update:function(a){var b=this.data();if(b.pageMv.length>0){var c=b.pageMv[0];l.updateCorner.call(this,c)}else b.options.autoCenter&&this.turn("center");return a&&l.updateShadow.call(this),this},peel:function(b,c,d,e){if(this.data("disabled"))return this;if(c=void 0===c||c,"hard"==b)var f=!0;else"soft"==b&&(f=!1);if(b=this.data("options").turnCorners.split(",")[0],c)l.peel.call(this,b,f,d,e);else{var g=this.data("pageMv");g.length>0&&(g[0].corner=b)}return this}},e="WebKit Moz O ms".split(" "),f="",g=document.createElement("div"),h={},i=function(a){for(var b=0;b<e.length;b++)if(e[b]+a in g.style)return e[b]+a;return""},j=function(){},k=function(){var a=navigator.userAgent.toLowerCase(),b=/(chrome)[ \/]([\w.]+)/.exec(a)||/(webkit)[ \/]([\w.]+)/.exec(a)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(a)||/(msie) ([\w.]+)/.exec(a)||a.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(a)||[];return{browser:b[1]||"",version:b[2]||"0"}},l={init:function(b){if(this.is(":visible"))l.calculateBounds.call(this,this.width(),this.height());else var c=this,d=setInterval(function(){c.is(":visible")&&(clearInterval(d),l.calculateBounds.call(c,c.width(),c.height()))},10)},has3d:function(){return"WebKitCSSMatrix"in window||"MozPerspective"in document.body.style||"msPerspective"in document.body.style||"OPerspective"in document.body.style},isTouchDevice:function(){return"ontouchstart"in window},gradient:function(a,b,c,d,e){var f=[];if("webkit"==k.browser)for(var g=0;g<d;g++)f.push("rgba("+c.r+","+c.g+","+c.b+","+(c.a-c.a*g/d).toFixed(2)+")");else{var h=e?-1:1;a.css({backgroundImage:i("LinearGradient")+"(left, "+l.colorToString(c)+" "+b+"%,rgba(0,0,0,0) 100%)"})}},peel:function(b,c,d,e){var f=this,g=this.data(),h=g.pagePlace;d=a.extend({page:g.page,next:g.page<g.totalPages?g.page+1:g.page,corner:b},d);var i=h[d.page],j=i.width(),k=i.height();if("tr"==b){d.x=d.x?d.x:j,d.y=d.y?d.y:0}else if("tl"==b){d.x=d.x?d.x:0,d.y=d.y?d.y:0}else if("br"==b){d.x=d.x?d.x:j,d.y=d.y?d.y:k}else if("bl"==b){d.x=d.x?d.x:0,d.y=d.y?d.y:k}else if("l"==b){d.x=d.x?d.x:0,d.y=d.y?d.y:k/2}else if("r"==b){d.x=d.x?d.x:j,d.y=d.y?d.y:k/2}var m=this.data("pageMv"),n=this.data("options");if(e=void 0!==e?e:!0,m.length>0&&n.acceleration&&e)return this;this.trigger("start",d);var o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D;if(g.pageMv.push(d),m=g.pageMv,o="double"==n.display?i.parent().parent():i.parent(),p=g.pageWrap,q={left:i.offset().left-o.offset().left,top:i.offset().top-o.offset().top},!c){var E=g.pages[d.page];i.css({position:"absolute",top:q.top,left:q.left,width:j,height:k}),p[d.page].show().css({left:q.left,top:q.top,width:j,height:k}),E.d.page=d.page,E.d.next=d.next,E.d.corner=d.corner,E.d.moved=0,E.d.peeling=0,E.d.force=0,E.d.z=o.css("z-index")||0,E.d.originalZ=o.css("z-index")||0,o.css({zIndex:E.d.z+1})}else{var F=g.pages[d.next];if(g.options.display=="double"){var G=g.pages[g.page].d,H=g.pagePlace[d.page],I=H.offset(),J=H.parent().parent().offset();I.left-=J.left,I.top-=J.top,F.d.z=g.pages[g.page].d.z-1,H.css({position:"absolute",top:I.top,left:I.left})}else F.d.z=g.pages[d.page].d.z+1;p[d.next].show()}return d.x=d.x-q.left,d.y=d.y-q.top,"r"==b||"l"==b?(s=d.y,t=d.x,B=Math.atan2(0,j-2*d.x),C=90-180*B/Math.PI,"l"==b?d.x=d.x-j:d.x=d.x+j,D=Math.sqrt(Math.pow(j,2)+Math.pow(0,2))):(s=d.x,t=d.y,B=Math.atan2(d.y,d.x),C=180*B/Math.PI,D=Math.sqrt(Math.pow(d.x,2)+Math.pow(d.y,2))),d.started=!0,g.peeling=d.page,l.turnPage.apply(this,[d.page,c]),e&&!this.data("mouseAction")?j=setInterval(function(){if(m[0]==d){var a=n.acceleration?"easeIn":"";d.peeled>=100?l.turned.call(f):l.peel.call(f,b,c,{x:s,y:t,peeled:d.peeled+10,a:a})}},100):this.turn("update"),this},autobind:function(){var b=this,c=this.data();if(!c.disabled){var d=c.pageWrap,e=a('<div class="turn-around"></div>'),f=1,g={};c.turning=null,c.corner=null;var h=function(h){if(!c.disabled&&!c.peeling){var i=this.attr("page")||c.page;if(c.corner=l.getCorner.call(b,i,h.pageX,h.pageY))if(a(h.target).attr("ignore")!="1"){var j=a.extend({},h);c.turning=i,c.mouseAction=!0,l.effect.call(b,c.corner.corner,j),b.bind("vmousemove",k).bind("vmouseup",m).data("mouseAction",!0)}}},i=function(d){if(!c.disabled){var e=this.attr("page")||c.page;if(l.isTouchDevice)d.preventDefault();else if(null===c.turning){var f=a.extend({},d.originalEvent.touches[0]);g={x:f.pageX,y:f.pageY},h.call(a(this),f)}}},j=function(b){if(!c.disabled)if(l.isTouchDevice){b.preventDefault();var d=a.extend({},b.originalEvent.changedTouches[0]);c.mouseAction&&(c.corner=l.getCorner.call(a(this),c.turning,d.pageX,d.pageY),k.call(a(this),d))}},k=function(a){if(!c.disabled&&c.turning)if(l.isTouchDevice)a.preventDefault(),l.effect.call(b,c.corner.corner,a,c.corner.x,c.corner.y);else{var d=Math.floor(c.corner.x),e=Math.floor(c.corner.y),f=Math.floor(a.pageX),g=Math.floor(a.pageY);d==f&&e==g||l.effect.call(b,c.corner.corner,a,c.corner.x,c.corner.y)}},m=function(d){if(!c.disabled&&c.mouseAction){if(l.isTouchDevice){var e=a.extend({},d.originalEvent.changedTouches[0]);d=e}b.unbind("vmousemove",k).unbind("vmouseup",m),c.mouseAction=!1;var f=b.data("pageMv");f.length>0&&(c.corner.corner?l.solve.call(b,c.corner.corner,d.pageX,d.pageY,f[0].peeled):l.solve.call(b,f[0].corner,d.pageX,d.pageY,f[0].peeled)),setTimeout(function(){c.turning=null},1)}c.mouseAction=!1};a(document).bind(l.isTouchDevice?"touchstart":"mousedown",function(a){for(var c=a.target;c&&"1"!=c.getAttribute("ignore");)c=c.parentNode;return"1"!=c.getAttribute("ignore")?void 0:void a.stopPropagation()}),a(this).bind("vmouseover",function(b){if(!c.disabled){var d=c.peeling||c.turning;if(!d)for(var g in d=l.getCorner.call(a(this),f,b.pageX,b.pageY))e.css({top:g.y,left:g.x}).attr("corner",g.corner),d=g.corner}}).bind(l.isTouchDevice?"touchstart":"mousedown",function(){var a=c.peeling||c.turning;a&&h.apply(this,arguments)}).bind("vmouseout",function(a){c.peeling}).bind("touchend",j),this.bind(l.isTouchDevice?"touchstart":"mousedown",i)}}},solve:function(b,c,d,e){var f=this.data(),g=f.pageMv;if(g.length>0){var h=g[0],i=h.peeled||e||0,j={x:h.x,y:h.y};if("r"==b||"l"==b)var k=c-j.x,m=k>0,n=100-i,o=n*f.options.acceleration,p=m?Math.min(k,n):Math.max(k,-o);else var k=c-j.x,m=k>0,n=i,o=100-i,p=m?Math.min(k,o):Math.max(k,-n);var q=a.extend(h,{ts:1,x:p+j.x,peeled:h.peeled,duration:600-600*i/100,easing:m?"easeIn":"easeOut"});l.effect.call(this,q.corner,q,q.x,q.y)}return this},effect:function(a,b,c,d){var e=this.data(),f=this.data("pageMv");if(f.length>0){var g=f[0],h=this.data("options"),i=this.width(),j=this.height();if("v"==a.substr(1))g.peeled=b.peeled||100*(b.pageY-d)/j;else g.peeled=b.peeled||100*("t"==a.substr(0,1)?b.pageX-c:c-b.pageX)/i;if(g.peeled>100)g.peeled=100;else if(g.peeled<0)return l.turned.call(this);if(f.length>0){var k=g,m=100-k.peeled;if(b.ts)var n=setInterval(function(){if(f[0]&&k==f[0]){var a=k.duration/10,b=(new Date).getTime()-k.ts,c=Math.round(100-100*(1-k.peeled/100)*Math.cos(.5*(Math.min(a,b)/a)*Math.PI));if("t"==k.corner.substr(0,1))k.x=k.peeled*i/100,k.y=k.y;else k.x=i-k.peeled*i/100,k.y=k.y;k.peeled=c,b>=a?(clearInterval(n),delete k.ts,l.turned.call(this)):l.turnPage.call(this,k.page,h.display=="double"&&k.page%2==0)}else clearInterval(n)},10);else"r"==a||"l"==a?(k.y=d,k.x=c):"t"==a.substr(0,1)?(k.x=b.pageX,k.y=b.pageY-m*j/100):(k.x=b.pageX,k.y=b.pageY+m*j/100),l.turnPage.call(this,k.page,h.display=="double"&&k.page%2==0)}return!1}},getCorner:function(b,c,d){var e,f=this.data("options"),g=this.width(),h=this.height(),i=f.turnCorners.split(",");if(b=this.data("pagePlace")[b])var j=b.offset();else{var k=this.offset();j={top:k.top,left:k.left}}var l=j.top,m=j.left;if(c>m&&c<m+g&&d>l&&d<l+h){var n=Math.floor(f.elevation);c-=m,d-=l;for(var o=0;o<i.length;o++)if("bl"==i[o]){if(c<n&&d>h-n)return{corner:"bl",x:c,y:d}}else if("br"==i[o]){if(c>g-n&&d>h-n)return{corner:"br",x:c,y:d}}else if("tl"==i[o]){if(c<n&&d<n)return{corner:"tl",x:c,y:d}}else if("tr"==i[o]){if(c>g-n&&d<n)return{corner:"tr",x:c,y:d}}else if("l"==i[o]){if(c<n)return{corner:"l",x:c,y:d}}else if("r"==i[o]){if(c>g-n)return{corner:"r",x:c,y:d}}}return!1},calculateBounds:function(a,b){var c=this.data();c.options;c.pages[0]={width:a,height:b}},resize:function(a,b){var c=this.data();c.pages[0].width=a,c.pages[0].height=b,this.turn("update")},createBook:function(){var b=this,c=this.data(),d=c.options;c.pagePlace={},c.pageWrap={},c.pageObjs={},c.pageZoom={},c.pages={},c.pageMv=[],"double"==d.display?this.addClass("shadow"):this.removeClass("shadow");for(var e=1;e<=c.totalPages;e++)c.pagePlace[e]=a('<div class="page-placeholder">').attr("page",e),c.pageObjs[e]=a('<div class="turn-page">').css({width:d.width,height:d.height}).attr("page",e),c.pageWrap[e]=a('<div class="page-wrapper">').attr("page",e),this.append(c.pagePlace[e]).append(c.pageWrap[e]),c.pagePlace[e].append(c.pageObjs[e])},addInsideBook:function(){var b=this,c=this.data(),d=this.children();c.inside=a('<div class="turn-inside">');var e=a('<div class="i-shadow">'),f="double"==c.options.display?1:0,g="double"==c.options.display?2:1;if(c.totalPages)for(var h=1;h<=c.totalPages;h++){var i=c.pageObjs[h];c.pagePlace[h].css({width:c.options.width,height:c.options.height}),c.pageWrap[h].css({width:c.options.width,height:c.options.height}),"double"==c.options.display?(h%2==0?c.pagePlace[h].addClass("even"):c.pagePlace[h].addClass("odd"),h%2==0?c.pageObjs[h].addClass("even"):c.pageObjs[h].addClass("odd"),c.pageWrap[h].css({left:h%2==0?"":c.options.width})):c.pageWrap[h].css({left:0}),c.pages[h]={d:[],p:null,f:{}},c.pageZoom[h]=a("<div>").css({position:"absolute"}).hide(),c.inside.append(c.pageZoom[h])}this.append(c.inside),this.append(e)},autobind:function(){var b=this;b.data();a(b).children().each(function(c){var d=a(this).attr("page")||c+1;b.turn("addPage",a(this),d)})},addPage:function(c,d){var e=this.data(),f=e.pageObjs[c],g=a("<div>",{"class":"page-content"}),h=!1;return f?(e.pageElement?e.pageElement[c]&&e.pageElement[c].remove():e.pageElement={},d.attr("page",c).css({width:this.width(),height:this.height()}),e.pageElement[c]=d,g.append(d),f.html("").append(g),h=!0):h},pageNumbers:function(a,b){for(var c=a;b>=c;c++){var d=this.data().pageObjs[c];d.find(".page-number").remove(),d.append('<div class="page-number">'+c+"</div>")}},calculateZ:function(b){var c=this,d=this.data(),e=d.page,f=b.length,g=f-1,h={pageZ:[],partZ:[],pageV:[]};for(var i=0;f>i;i++){var j=b[i].page,k=d.pages[j],m=d.pagePlace[j].offset(),n=d.pageWrap[j].offset(),o=c.offset();if(m.top-=o.top,m.left-=o.left,n.top-=o.top,n.left-=o.left,"double"==d.options.display)var p=j%2==0;else var p=!1;var q=d.pages[e].d.z;h.pageZ[j]=d.totalPages-Math.abs(e-j)+1,h.partZ[j]=d.totalPages*2+1-Math.abs(e-j),p?j>e?h.pageV[j]=1:j<e&&(h.pageV[j]=0):j<e?h.pageV[j]=1:j>e&&(h.pageV[j]=0),d.pages[j].d.z=h.pageV[j]?h.pageZ[j]+q:q,g>i&&j!=b[i+1].page&&(d.pages[b[i+1].page].d.z=h.partZ[j]-1)}return h},turned:function(){var b=this,c=this.data(),d=c.pageMv[0];this.trigger("turned",[d.next,this.turn("view",d.next)]),d.next==c.totalPages&&this.trigger("last"),1==d.next&&this.trigger("first"),this.turn("update"),c.peeling=null},turnPage:function(c,d){var e,f,g=this,h=this.data(),i=h.options,j=h.pages[c],k=h.pageWrap[c],m=k.children().first(),n=h.pages[j.d.next],o=h.pageWrap[j.d.next],p=o.children().first();if(j.d.corner){var q=k.parent().offset(),r=k.offset();if(e=Math.max(0,Math.sin(j.d.a)*j.d.radius),j.d.force>0){var s=i.acceleration?.1:0;j.d.peeling=Math.min(1,j.d.peeling+j.d.peeling/10+s)}else j.d.peeling=Math.max(0,j.d.peeling-j.d.peeling/20);var t,u,v,w,x,y,z,A,B=Math.round(100*j.d.peeling)/100,C="double"==i.display?c%2:0;switch(j.d.corner){case"l":t=0,u=j.d.y-j.d.y*B,v=j.d.x-Math.cos(j.d.a)*j.d.radius*(1-B),w=1-B,x=B,y="0% 50%",z="100% 50%",A=i.height,d||(v-=i.width*B);break;case"r":t=j.d.x*B,u=j.d.y-j.d.y*B,v=j.d.x+Math.cos(j.d.a)*j.d.radius*(1-B),w=B,x=1-B,y="100% 50%",z="0% 50%",A=i.height,d||(v-=i.width*B);break;case"tl":t=0,u=j.d.peeled,v=j.d.peeled*j.d.p,w=1-B,x=B,y="0% 0%",z="100% 100%",A=Math.sqrt(Math.pow(i.width,2)+Math.pow(i.height,2)),d||(v-=i.width*B);break;case"tr":t=j.d.x-j.d.x*B,u=j.d.peeled,v=j.d.x-j.d.peeled*j.d.p,w=B,x=1-B,y="100% 0%",z="0% 100%",A=Math.sqrt(Math.pow(i.width,2)+Math.pow(i.height,2)),d||(t-=i.width*(1-B),v-=i.width*B);break;case"bl":t=0,u=j.d.y-j.d.peeled,v=j.d.peeled*j.d.p,w=1-B,x=B,y="0% 100%",z="100% 0%",A=Math.sqrt(Math.pow(i.width,2)+Math.pow(i.height,2)),d||(v-=i.width*B);break;case"br":t=j.d.x-j.d.x*B,u=j.d.y-j.d.peeled,v=j.d.x-j.d.peeled*j.d.p,w=B,x=1-B,y="100% 100%",z="0% 0%",A=Math.sqrt(Math.pow(i.width,2)+Math.pow(i.height,2)),d||(t-=i.width*(1-B),v-=i.width*B)}f={transform:"rotate("+j.d.turnAmount+"deg) translate("+t+"px, "+u+"px) skew("+j.d.skew+"deg, 0deg)"},j.d.z<n.d.z?m.css({zIndex:n.d.z+1}):p.css({zIndex:j.d.z+1});var D=a.extend({},f);if(h.has3d)D[i.transform]="rotate3d(0, 0, 1, "+j.d.turnAmount+"deg) translate3d("+t+"px, "+u+"px, 0px) skew("+j.d.skew+"deg, 0deg)";else for(var E in D)D[E]=D[E];var F=a("<div>").css({position:"absolute",top:0,left:0}),G=a("<div>").css({position:"absolute",top:0,left:0}),H=a("<div>").css({position:"absolute",top:0,left:0}),I={width:i.width,height:i.height},J=i.width*B/2,K=i.width/2;if(j.d.gradient&&"webkit"==k.browser){var L=150;switch(j.d.corner){case"l":f={position:"absolute",width:K,height:i.height,left:K,top:0,background:i.gradient(0,.5,{r:0,g:0,b:0,a:.2},L,C)};break;case"r":f={position:"absolute",width:K,height:i.height,left:0,top:0,background:i.gradient(0,.5,{r:0,g:0,b:0,a:.2},L,C)};break;case"bl":f={position:"absolute",width:"200%",height:"200%",left:"-50%",top:"-50%",background:"-webkit-gradient(linear, "+j.d.x+"% "+(i.height-j.d.y)+"%, "+(j.d.x-B*j.d.x)+"% "+(i.height-j.d.y+B*j.d.y)+"%, from(rgba(0,0,0,0)), to(rgba(0,0,0,"+(1-B)+")), color-stop(.5,rgba(0,0,0,"+(1-B)+")))"};break;case"br":f={position:"absolute",width:"200%",height:"200%",left:"-50%",top:"-50%",background:"-webkit-gradient(linear, "+j.d.x+"% "+j.d.y+"%, "+(j.d.x-B*j.d.x)+"% "+(j.d.y-B*j.d.y)+"%, from(rgba(0,0,0,0)), to(rgba(0,0,0,"+(1-B)+")), color-stop(.5,rgba(0,0,0,"+(1-B)+")))"};break;case"tl":f={position:"absolute",width:"200%",height:"200%",left:"-50%",top:"-50%",background:"-webkit-gradient(linear, "+j.d.x+"% "+j.d.y+"%, "+(j.d.x+B*j.d.x)+"% "+(j.d.y+B*j.d.y)+"%, from(rgba(0,0,0,0)), to(rgba(0,0,0,"+(1-B)+")), color-stop(.5,rgba(0,0,0,"+(1-B)+")))"};break;case"tr":f={position:"absolute",width:"200%",height:"200%",left:"-50%",top:"-50%",background:"-webkit-gradient(linear, "+(j.d.x-i.width)+"% "+j.d.y+"%, "+(j.d.x-i.width+B*j.d.x)+"% "+(j.d.y+B*j.d.y)+"%, from(rgba(0,0,0,0)), to(rgba(0,0,0,"+(1-B)+")), color-stop(.5,rgba(0,0,0,"+(1-B)+")))"}}F.css(f).addClass("shadow-part")}},updateCorner:function(a){var b=this,c=this.data();if(c.pageMv[0]){var d=c.pageMv[0],e=this.width(),f=this.height(),g=d.peeled>100?100:d.peeled;if("r"==d.corner)d.x=e-g*e/100,d.a=Math.asin(d.y/Math.sqrt(Math.pow(e-d.x,2)+Math.pow(d.y,2))),d.turnAmount=90-100*Math.round(1e3*d.a/Math.PI)/1e3/2,d.skew=d.turnAmount/2,d.radius=e,d.p=e/d.y;else if("l"==d.corner)d.x=g*e/100,d.a=Math.asin(d.y/Math.sqrt(Math.pow(d.x,2)+Math.pow(d.y,2))),d.turnAmount=-(90-100*Math.round(1e3*d.a/Math.PI)/1e3/2),d.skew=d.turnAmount/2,d.radius=e,d.p=e/d.y;else if("tr"==d.corner)d.x=e-g*e/100,d.a=Math.atan(f/e),d.turnAmount=-(90-g),d.radius=Math.sqrt(Math.pow(e,2)+Math.pow(f,2))/2,d.p=e/f,d.skew=Math.atan(g/100)*10;else if("tl"==d.corner)d.x=g*e/100,d.a=Math.atan(f/e),d.turnAmount=90-g,d.radius=Math.sqrt(Math.pow(e,2)+Math.pow(f,2))/2,d.p=e/f,d.skew=-(Math.atan(g/100)*10);else if("br"==d.corner)d.x=e-g*e/100,d.a=Math.atan(f/e),d.turnAmount=90-g,d.radius=Math.sqrt(Math.pow(e,2)+Math.pow(f,2))/2,d.p=e/f,d.skew=-(Math.atan(g/100)*10);else if("bl"==d.corner)d.x=g*e/100,d.a=Math.atan(f/e),d.turnAmount=-(90-g),d.radius=Math.sqrt(Math.pow(e,2)+Math.pow(f,2))/2,d.p=e/f,d.skew=Math.atan(g/100)*10;d.peeled=g,l.turnPage.call(this,d.page,c.display=="double"&&d.page%2==0)}return this},updateShadow:function(){var b=this,c=this.data(),d=c.options,e=c.page,f="double"==d.display?2:1,g=this.turn("view");this.removeClass("shadow");for(var h in g)if(b(g[h]).hasClass("hard"))for(var i=b.turn("view",g[h]),j=i[0]?i[0]:i[1],k=b.turn("view",c.page),l=0;l<f&&j>0&&e>1;l++){var m=b.data("pagePlace")[j];m&&m.removeClass("shadow-page"),j=b.turn("previousPage",j)}for(var i=b.turn("view",c.page),j=i[0]?i[0]:i[1],k=b.turn("view",c.page),l=0;l<f&&j<c.totalPages&&j>0;l++){j=b.turn("nextPage",j);var m=b.data("pagePlace")[j];m&&m.addClass("shadow-page")}},moveTo:function(a){var b,c=this,d=this.data(),e=d.options,f=this.turn("view",a);this.trigger("turning",[a,f]),d.page=a,d.peeling=null,"double"==e.display&&(b=a%2,1==b?d.peeling=d.totalPages:d.peeling=1),e.acceleration?this.animationStop().animation({queue:!1,duration:e.duration,easing:"swing",done:function(){c.trigger("turned",[a,f]),c.animationStop()}}):this.trigger("turned",[a,f]),1==a&&this.trigger("first"),a==d.totalPages&&this.trigger("last"),d.peeling&&this.turn("peel","hard")},display:function(a){var b=this.data(),c=b.options.display,d=this.turn("page");b.options.display=a,"double"==a?(this.addClass("shadow"),l.createBook.call(this)):(this.removeClass("shadow"),l.createBook.call(this)),this.turn("page",d)},options:function(c){var d=this,e=this.data(),f=e.options;a.extend(f,c),f.pages&&this.turn("pages",f.pages),f.display&&this.turn("display",f.display)},nextPage:function(a){a=a||this.data().page;var b=this.data();return a<b.totalPages?a+("double"==b.options.display?2:1):a},previousPage:function(a){a=a||this.data().page;var b=this.data();return a>1?a-("double"==b.options.display?2:1):a},view:function(a){var b=this.data();if(a=a||b.page,"double"==b.options.display){var c=a%2;return 1==c?[a,a+1]:[a-1,a]}return[a]},zoom:function(b){var c=this,d=c.data(),e=d.options,f=1/b,g=this.data("pagePlace"),h=d.pageWrap,i=this.data("pageObjs"),j=this.data("pageZoom"),k=this.data("pages"),m=this.offset(),n=a("<div>",{"class":"turn-zoom"}).css({position:"absolute"}),o=this.data("pageMv"),p=this.turn("view"),q=p.join("-");return this.turn("stop"),d.zoom=f,1==f?(this.turn("page",d.page),this):(this.bind("vmousemove",function(a){if(o.length>0){var b=o[0],c=p.join("-");c==q&&(d.zoomPos.x=a.pageX-m.left-b.x*f,d.zoomPos.y=a.pageY-m.top-b.y*f,l.zoomMethods.transform.call(c,d.zoomPos.x,d.zoomPos.y))}}).bind("vmouseup",function(a){c.unbind("vmousemove").unbind("vmouseup"),d.zooming=null,l.zoomMethods.end.call(c,p,e.duration)})).trigger("zooming",[f,d.page]),n.css({width:2*e.width,height:2*e.height}),d.zooming=a.extend({},d.zoomPos||{x:0,y:0}),this.turn("page",p[0]),l.zoomMethods.start.call(this,p),this)}};window.Modernizr?Modernizr.addTest("csstransforms3d",function(){var a=!!i("Perspective");return a&&"webkitPerspective"in document.body.style&&(a=Modernizr.testStyles("@media (-webkit-transform-3d){#csstransforms3d{left:9px;position:absolute;height:3px;}}",function(a){return 9===a.offsetLeft&&3===a.offsetHeight})),a}):l.has3d=i("perspective")?l.has3d():!1,a.extend(a.fn,{turn:function(a){var b=Array.prototype.slice.call(arguments,1);return d[a]?d[a].apply(this,b):"object"!=typeof a&&a?void("version"==a&&console.info("Turn.js v4.1.0")):(b.unshift(a),c.apply(this,b))}});var m={"":{width:"width",height:"height",gradient:function(a){return l.gradient.call(this,a.page,a.b,a.color,a.w,a.left)}}};a.isTouch=l.isTouchDevice(),a.has3d=l.has3d(),a.findNext=function(a,b,c){var d,e=a.children(":first");do{if(d=e.hasClass(b),!d&&e.children().length>0)return findNext(e,b);e=e.next()}while(!d&&e.length>0);return e}}("jQuery"in window?window.jQuery:window.Zepto);