<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Comentarios de PDF por IAs</title>
<style>
  body { font-family: Arial, sans-serif; padding: 20px; background: #f0f0f0; }
  #pdfText { width: 100%; height: 200px; margin-top: 10px; }
  #comments { margin-top: 20px; }
  .llm-comment { background: #fff; padding: 10px; margin: 5px 0; border-radius: 5px; }
  .gemini { border-left: 5px solid #4CAF50; }
  .openai { border-left: 5px solid #2196F3; }
</style>
</head>
<body>
<h1>Sube un PDF y recibe comentarios de Gemini y OpenAI</h1>
<input type="file" id="pdfInput" accept=".pdf">
<button onclick="procesarPDF()">Procesar PDF</button>

<h2>Texto extra√≠do:</h2>
<textarea id="pdfText" readonly></textarea>

<h2>Comentarios de las IAs:</h2>
<div id="comments"></div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.8.162/pdf.min.js"></script>
<script>
async function procesarPDF() {
    const file = document.getElementById('pdfInput').files[0];
    if(!file) return alert("Sube un PDF primero");

    const arrayBuffer = await file.arrayBuffer();
    const pdf = await pdfjsLib.getDocument(arrayBuffer).promise;

    let text = "";
    for(let i=1; i<=pdf.numPages; i++){
        const page = await pdf.getPage(i);
        const content = await page.getTextContent();
        text += content.items.map(item => item.str).join(" ") + "\n\n";
    }
    document.getElementById('pdfText').value = text;

    // Llamar backend para comentarios
    const response = await fetch("http://localhost:3000/comentarios", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ text })
    });
    const data = await response.json();

    const commentsDiv = document.getElementById('comments');
    commentsDiv.innerHTML = `
        <div class="llm-comment gemini"><strong>Gemini:</strong> ${data.geminiComment}</div>
        <div class="llm-comment openai"><strong>OpenAI:</strong> ${data.openaiComment}</div>
    `;
}
</script>
</body>
</html>
